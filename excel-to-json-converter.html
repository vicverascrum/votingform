<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel to JSON Converter</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        textarea { width: 100%; height: 200px; margin: 10px 0; }
        button { background: #1a73e8; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        .output { background: #f5f5f5; padding: 15px; border-radius: 4px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Excel to JSON Converter for Survey Form</h1>
    <p>Paste your Excel data (CSV format) below:</p>
    
    <textarea id="csvInput" placeholder="Paste CSV data here...
Example format:
ID,Type,Title,Required,Option1Value,Option1Label,Option2Value,Option2Label,Option3Value,Option3Label
question1,radio,Your question here?,true,high,High Priority,medium,Medium Priority,low,Low Priority"></textarea>
    
    <button onclick="convertToJSON()">Convert to JSON</button>
    
    <h3>Generated JSON:</h3>
    <div id="output" class="output"></div>
    
    <script>
        function convertToJSON() {
            const csv = document.getElementById('csvInput').value;
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            
            const questions = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const question = {
                    id: values[0],
                    type: values[1],
                    title: values[2],
                    required: values[3] === 'true'
                };
                
                if (question.type === 'radio') {
                    question.options = [];
                    for (let j = 4; j < values.length; j += 2) {
                        if (values[j] && values[j + 1]) {
                            question.options.push({
                                value: values[j],
                                label: values[j + 1]
                            });
                        }
                    }
                }
                
                questions.push(question);
            }
            
            const result = {
                formTitle: "Sprint Prioritization for Sprint 22",
                subtitle: "Hi, Victor. When you submit this form, the owner will see your name and email address.",
                questions: questions
            };
            
            document.getElementById('output').textContent = JSON.stringify(result, null, 2);
        }
    </script>
</body>
</html>
